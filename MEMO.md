
※ 以下、未検証の内容を含みます


## 誤差・情報落ちについて

    数値表記の誤差 ... 少数第二位以下。
                    表示が切捨てなら 0.1ms 未満、四捨五入なら 0.05ms以下。

    波形表示の誤差 ... 波形のサンプリング周期。(波形を目視で確認した場合)
                    速度とメモリの都合上、波形のレンダリングは通常、適度に間引いて表示されます。
                    REAPERの設定、オーディオ・レンダリングで設定可能。初期値は auto です。
                    拡大時にどの程度の精度で視認できるのかは不明。

    除算で生じる丸め誤差 ... REAPERでのアイテムの位置情報の精度はdouble型(秒数)
    http://www.cc.kyoto-su.ac.jp/~yamada/programming/float.html

    計算の丸め誤差は表示の誤差に比べると極微細(レート192kHzでも1サンプル未満)ですが、
    誤差が蓄積するような状況（ループ等)で顕在することがあります。

    ※ 同期の取れない外部デバイスでループを流す場合、ms単位指定かつ中途半端なBPMだったりすると、
    1サンプルの誤差でも累積して大きなずれになる可能性があります。NINJAMで長時間流す場合等。
    ※ 実際には、プロセッサのクロック数の違いからくるタイミングの誤差等、他にもずれる要因はあります。


    デジタルの信号データの再生やミックスでは、コンピュータ上サンプル単位で処理されますが、
    REAPERのプロジェクト・ファイル内では、アイテムの位置は秒数で記録されています。

    この場合の秒数で指定することの利点は、
    サンプリング・レートに関らず、1サンプル未満の時間も記録するのに充分な精度があるので、
    音声データのサンプリング・レートの変換があった際でも、情報落ちの誤差をなくせます。
    MIDIアイテムにしても、MIDIの分解能やテンポに依存しない単位のタイムで指定できます。

    Reaperのプロジェクト・ファイル (.RPP) はテキスト・エディタで開いて見ても、
    メディア・アイテム自体のプロパティにはサンプリング・レートの情報は記録されていません。
    各メディア・ファイル(.wav等)に記載されています。

    44.1kHz: 1 / 44100 = 約 0.00002675 seconds = 約 0.02675 ms

    192kHz: 1 / 192000 = 約 0.00000520 seconds = 約 0.00520ms

    対して、浮動点小数の有効桁数は(10進数で)約15桁なので

    0.00000000000001 = 0.00000000001ms = 0.00000001μm = 0.00001nm ...


    精度は double 型での秒数の方が細かいのですが、
    実際のデータ上の遅延はサンプル単位なので、サンプル単位の方が正確です。

    但し、サンプル単位で正確に遅延を補正した場合でも、
    各トラック間でサンプリング・レートが異なり＆レンダリング後にサンプリング・レートの変異がある場合、
    補正の精度の差によるずれが生じる場合があります。

    サンプリング・レートの異なるアイテム間の補正で誤差を少なくする為には、
    各アイテム内の音声データのサンプリング・レートを統一し、
    出来るだけサンプル数/サンプリングレートの倍数に近い秒数を指定して補正すると良いです。


## NINJAMセッション上でのレイテンシの累積

  * 全員がメトロノームのクリックを基準に演奏した場合

    全員一律、個々の遅延補正だけで済むはず。

  * メトロノームをオフにして、ドラム（ドラムや伴奏等)を基準に合わせて演奏した場合

    基準となったトラックに遅延補正を掛けると、
    それに合わせて演奏している各トラックとの間で演奏のタイミングにずれが出るはずです。
    ドラムに合わせる以外にも、ユニゾンのフレーズ等で他のパートに合わせている場合等、
    様々な状況が考えられます。（※実際に、このような状況でのずれに影響するか検証はしてません）

    部分部分の遅延を判断して補正を掛けるのは、
    セッションが長時間なのを考えると、あまり現実的ではありません。

    補正値が小さければ、誤差として処理しても良い程度だとは思います。


## 最小構成の ReaScript を動かす為の環境構築についてのメモ

 ReaScriptの実行には、最低限 PythonのDLL ファイル一個で済むので、
 以下の方法で最小構成の環境を構築できます。

  1. 通常通り Python をインストール
  2. システムフォルダ等にインストールされた DLL を何処かにコピー
  3. Python をアンインストール
  4. REAPER では Custom Path を設定して DLL を指定

  * レジストリ等の環境を汚すことなく、環境構築したい場合は、
    Pythonをインストールしたマシンから、DLLファイルをコピー。

  * このスクリプト(rea.py)では、標準ライブラリのcontextlib.py ファイルを利用しているので、
    DLL以外にもうひとつ ./Lib/contextlib.py のコピーも必要です。


  デメリットについて、
  人によっては導入コスト以上に運用コストが高くつく事があるかもしれません。

  * この構成で、いろいろなスクリプトを動かす場合は、
    必要なライブラリが見当たらない等のトラブルが容易に予想されます。

  * 標準構成の場合は、トラブル等は検索すると前例・解決策が見つかることがありますが、
    カスタム構成の場合は、自力で解決しないといけない事があります。


## このアイテムの位置補正スクリプトの使い所について

  実験してみたら動いた程度の品質で、運用実績はありません。

  人手が必要な場面には使えないので、いろんな状況を考えると、使える場面はそれ程多くないと思います。
  毎回、波形から遅延の程度を調べて、遅延テーブルのデータを編集して・・・では作業コストが増えます。

  手作業の方が早く出来るようなケースと較べると、
  複数の操作を纏めて1アクションでUNDO/REDO可能にする位しかメリットがないので、

  作業負担の軽減に繋がるようなケース・・・
  各自の設定が安定した状態で、毎週同じ処理を繰り返し行うような場合に、
  利用を検討してみてください。
